---
title: Vue-元件設計
description: pure component
---

###### tags: `想知道嗎`

# Vue 元件/頁面設計


## Atomic Design ( 原子設計 )
![](https://i.imgur.com/a2JP4WM.png)

### 概念 :
* ATOMS : "原子", 構成 網頁/程式 最小單位。
* MOLECULES : "分子", 由 "原子" 組成的結構。
* ORGANISMS : "組織", 由 "分子" 組成有複合性 功能/畫面 的結構。
* PAGES : "頁面", 由 "原子 分子 組織" 組成的複合性頁面。

### 實務使用

![](https://i.imgur.com/nG5drrP.png)

#### 優點 :
* 元件之間產生"階層感"。
* 隱藏元件的複雜度。
* 各元件的關注點分離。
* 更大程度的復用。
* 重新抽象 "元件" 概念, 進行資料夾分類。
* 更好維持程式碼的"整體概念性"。


#### 缺點 :

* 提高一定程度的複雜度。
* 元件的抽象語法表示。
* 資料/畫面 邏輯會集中於 Views。

## Single-File Components ( Pure Component )

### Pure Function

:::tip
* 輸出與輸入有關。
* 沒有 Side effect。
    * 不使用 function scope 以外的 data。
```js
 const text = "text";

 function foo (){
     console.log(text);
 }

 foo();
```
* 輸出不變。
    ex: JS map array methods。
```js
const foo = [{key:"aaa"}, {key:"bbb"}];

const customFoo = foo.map((item, index)=>{
    return {...item, id:index};
});

console.log(customFoo);// [{foo:"aaa",id:0}, {foo:"bbb",id:1}]
```
:::

### Pure Component

:::tip
* 輸出 ( emits ) 與 輸入 ( props ) 有關。
* 沒有 Side effect。
    * component 直接使用 VueX/Pinia。
    * component 直接打 api。
    * component 直接存取 。cookie/localStorage/sessionStorage ...等。
* 輸出不變。

:::

### 元件與頁面關係 
* 輸出(emit) 和 輸入(props)

![](https://i.imgur.com/U5M2jI0.png)


### 實務使用

```vue
//views
<script setup>
import { ref } from "vue";
import BaseInput from "@/BaseInput.vue"
import BaseVModelInput from "@/BaseVModelInput.vue"

const unVmodelDemo = ref("un-vmodel")
const vmodelDemo = ref("vmodelDemo")

</script>

<template>
  <BaseVModelInput v-model="vmodelDemo"></BaseVModelInput>

  <BaseInput
    :modelValue="unVmodelDemo"
    @update:modelValue="unVmodelDemo = $event"
  ></BaseInput>

</template>
```
:::tip
修改的資料 ( unVmodelDemo, vmodelDemo) 被定義在 "views"。

透過 prop 傳入元件 :modelValue / v-model

元件透過 emit / v-model 將資料傳回 "views" 更新資料

:::


## v-model / unV-model

<script setup>
import { ref } from "vue";
import BaseInput from "@/BaseInput.vue"
import BaseVModelInput from "@/BaseVModelInput.vue"

const unVmodelDemo = ref("un-vmodel")
const vmodelDemo = ref("vmodelDemo")
const user = ref({name:""})

const allUsers = ref([{id:1,name:""}, {id:2,name:""}]);


</script>

<style lang="sass" scoped>
.demo
  width: 55%
  min-width: 100px
  padding: 20px
  margin-top: 10px
  background-color: grey
  border-radius: 10px
.text-show
  /* width: 50% */
  min-width: 100px
  min-height: 30px

.immutable-demo
  margin-top: 15px
.array-demo
  margin-top: 15px
  &::first-child
    margin-top: 0
</style>

### v-model :

*  保持 get set 提高可讀性。
*  對 checkbox, radiobox 有優化。

<div class="demo">
  <p class="text-show">{{vmodelDemo}}</p>
  <BaseVModelInput
    class="vmodel-demo"
    label="vmodel-demo 以下可直接輸入"
    placeHolder="可輸入"
    v-model="vmodelDemo"
  ></BaseVModelInput>
</div>

```vue
// BaseVModelInput.vue
<script setup>
import { toRefs, computed } from "vue";

const emits = defineEmits(["update:modelValue"]);

const props = defineProps({
  modelValue: {
    type: String,
    default: "",
  },
});

const { modelValue } = toRefs(props);

const updateText = computed({
  get() {
    return modelValue.value;
  },
  set(newData) {
    emit("update:modelValue", newData);
  },
});

</script>

<template>
  <input v-model="updateText" />
</template>
```


### unV-model :

*  對我而言更直覺的元件設計。
*  v-on:event="do something", v-bind:value="value" 表示"行為" "資料"。

<div class="demo">
  <p class="text-show">{{unVmodelDemo}}</p>
  <BaseInput
    class="un-vmodel-demo"
    labelStyle="blue"
    label="un-vmodel-demo 以下可直接輸入"
    placeHolder="可輸入"
    :modelValue="unVmodelDemo"
    @update:modelValue="unVmodelDemo = $event"
  ></BaseInput>
</div>


```vue
// BaseInput.vue
<script setup>
import { toRefs } from "vue";

const emits = defineEmits(["update:modelValue"]);

const props = defineProps({
  modelValue: {
    type: String,
    default: "",
  },
});

const { modelValue } = toRefs(props);

</script>

<template>
  <input
    @input="$emit('update:modelValue', $event.target.value)"
    :value="modelValue"
  />
</template>

```

## mutable / immutable

### mutable :

:::tip
* 更動原始資料
```js
const arr = [];
const obj = {};

arr.push(1);// push 會更動原陣列
obj.id = 1 ;

console.log(arr); // [1]
console.log(obj); // {id:1}
```

![](https://i.imgur.com/iyAYoAu.png)

![](https://i.imgur.com/j3zmSD7.png)
:::

:::tip
  資料變動, 畫面變動

  記憶體位置沒發生變動, 有機會畫面不會更新

  圖片參考:  [immutable Chris 鐵人賽](https://ithelp.ithome.com.tw/articles/10269649)
:::

---

### immutable :

:::tip
* 資料不可變, 但可以更新

```js
let arr = [1,2]
let obj = {id:2,name:"test"};
arr = [...arr, 1]
obj = {...obj, id:1};

console.log(arr); 
console.log(obj); 
```

![](https://i.imgur.com/3HjdzBc.png)

![](https://i.imgur.com/IDvgZ4y.png)
:::

:::tip
觸發記憶體位置變動 => 畫面一定可以更新

* 可確保畫面一定更新
* 直接在程式碼看到資料結構

圖片參考:  [immutable Chris 鐵人賽](https://ithelp.ithome.com.tw/articles/10269649)

:::

### 實務使用

<div class="demo immutable-demo">
  <p class="text-show">User {{ user }}</p>
  <BaseInput
    class="un-vmodel-demo"
    labelStyle="blue"
    label="update user name 以下可直接輸入"
    placeHolder="可輸入"
    :modelValue="user.name"
    @update:modelValue="user = {...user,name:$event}"
  ></BaseInput>
</div>

```vue
<script setup>
  import { ref } from "vue";
  const user = ref({name:""});
</script>

<tempalte>
  <BaseInput
    :modelValue="user.name"
    @update:modelValue="user = {...user,name:$event}">
   </BaseInput>
</template>
```


<div class="demo immutable-demo-2">
  <p class="text-show">{{ allUsers }}</p>
  <div class="array-demo" v-for="(user,index) in allUsers" :key="user.id">
    <BaseInput
      class="un-vmodel-demo"
      labelStyle="blue"
      placeHolder="可輸入"
      :label="`Update user name ${user.id} 以下可直接輸入`"
      :modelValue="user.name"
      @update:modelValue="allUsers = [
            ...allUsers.slice(0,index),
            {...allUsers[index], name:$event },
            ...allUsers.slice(index+1)
      ]">
    </BaseInput>
  </div>
</div>


```vue
<script setup>
  import { ref } from "vue";

  const allUsers = ref([{id:1,name:""}, {id:2,name:""}]);

</script>

<tempalte>
  <div class="array-demo" v-for="(user,index) in allUsers" :key="user.id">
    <BaseInput
      :modelValue="user.name"
      @update:modelValue="allUsers = [
            ...allUsers.slice(0,index),
            {...allUsers[index], name:$event },
            ...allUsers.slice(index+1)
          ]">
    </BaseInput>
  </div>
</template>
```


## StoryBook

[StoryBook 官網](https://storybook.js.org/docs/vue/get-started/introduction)

--最後一哩路 - 元件文件化

* 管理設計好的元件庫
* 提供設計師元件參考

[StoryBook Demo](https://roaring-dolphin-dab485.netlify.app/?path=/story/base-basebutton--button)

```vue
// BaseButton.vue
<script setup>
 import { toRefs } from "vue";
 defineEmits(["buttonClick"]);
 const props = defineProps({
   title: {
     type: String,
     default: "",
   },
   buttonStyle: {
     type: String,
     default: "",
   },
   disabled: {
     type: Boolean,
     default: false,
   },
 });

 const { title, buttonStyle, disabled } = toRefs(props);
</script>
<template>
  <button
    type="button"
    :disabled="disabled"
    class="baseButton baseButton--theme"
    :class="[buttonStyle, { disabled: disabled }]"
    @click.prevent="$emit('buttonClick')"
  >
    {{ title }}
  </button>
</template>

<style lang="sass" scoped>
.baseButton--theme
  --theme-background: #F4F4F4
  --theme-textColor: #54667A
  --theme-border: #F4F4F4
  --theme-hover-background: #54667A
  --theme-hover-textColor: #FFFFFF
  --theme-hover-border: #54667A

.baseButton--theme.navy
  --theme-background: #374A60
  --theme-textColor: #fff
  --theme-border: #374A60
  --theme-hover-background: #fff
  --theme-hover-textColor: #374A60
  --theme-hover-border: #374A60

.baseButton--theme.white
  --theme-background: #ffffff
  --theme-textColor: #54667A
  --theme-border: #54667A
  --theme-hover-background: #54667A
  --theme-hover-textColor: #FFFFFF
  --theme-hover-border: #54667A
  
.baseButton
    font-size: 16px
    padding: 7px
    border-radius: 5px
    outline: unset
    background-color: var(--theme-background)
    color: var(--theme-textColor)
    border: 1px solid var(--theme-border) 
    cursor: pointer
    &:hover
      color: var(--theme-hover-textColor)
      background-color: var(--theme-hover-background)
      border: 1px solid var(--theme-hover-border)
    .editIcon
      display: none
    &.disabled
      opacity: 50%
      cursor: not-allowed
</style>
```

```js
//BaseButton.stories.js
import BaseButton from "../components/BaseButton.vue";
export default {
  title: "Base/BaseButton",
  component: BaseButton,
  argTypes: {
    title: "check",
    buttonStyle: {
      control: { type: "select" },
      options: ["none", "navy", "white"],
    },
    buttonClick: {
      description: "@buttonClick",
      default: "buttonClick",
      control: {
        type: null,
      },
    },
    onClick: { action: "clicked" },
    disabled: false,
  },
};

const Template = (args) => ({
  components: { BaseButton },
  setup() {
    const onClick = () => {
      console.log("hi");
    };
    return { args, onClick };
  },
  template: '<base-button v-bind="args"/>',
});

export const Button = Template.bind({});
Button.args = {
  title: "Demo",
  buttonStyle: "",
};
```


---
#### 參考:

:::tip
* [網頁設計 : Atomic Design簡介及工作實例](https://medium.com/uxeastmeetswest/%E7%B6%B2%E9%A0%81%E8%A8%AD%E8%A8%88-atomic-design%E7%B0%A1%E4%BB%8B%E5%8F%8A%E5%B7%A5%E4%BD%9C%E5%AF%A6%E4%BE%8B-42e666358d52)
* [Single-File Components](https://vuejs.org/guide/scaling-up/sfc.html#how-it-works)
* [Built-in Directives](https://vuejs.org/api/built-in-directives.html)
* [pure component Chris 鐵人賽](https://ithelp.ithome.com.tw/articles/10267499)
* [immutable Chris 鐵人賽](https://ithelp.ithome.com.tw/articles/10269649)
* [StoryBook 官網](https://storybook.js.org/docs/vue/get-started/introduction)
:::

<p>
PS: 使用任何框架, 請按照官方文件寫, 給後續要 擴充/維護 的人有勇氣繼續寫下去, <br /> 
不照文件寫, 繼續 擴充/維護 的勇氣, 梁靜茹也給不了。
<br />
<br />
如無法提供不按照文件寫的文件那就照官方文件寫, 共勉之。
</p>




